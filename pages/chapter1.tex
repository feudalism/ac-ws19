\section{Linear SISO plant}
\input{./pages/control-problem}~

Solutions for $u(t)$ using
\begin{itemize}
\item Model reference control (MRC)
\item Model reference adaptive control (MRAC)
\end{itemize}

\subsection{Model reference control (MRC)}
\input{./pages/mrc}

\subsection{Model reference adaptive control (MRAC)}
\input{./pages/mrac}

\section{Nonlinear SISO plant}
\input{./pages/nonlin-siso}

\section{Lyapunov-like functions}
\input{./pages/lyapunov-like-fcns}

\section{Barbalat's lemma}
\input{./pages/barbalat}
% \subsection{Kalman-Yakobovich Lemma (KY)}
% ``Maier version; how to design a controller given SPR''\\
% 
% \begin{itemize}
% \item Given a scalar $\gamma \geq 0$, vectors $b$ and $c$,
%     an asymptotically stable matrix $A$ %
%     \footnote{positive eigenvalues}
%     and a positive definite matrix $L$,
% \item If $H(s) \corresponds \frac{1}{2} \gamma + c^T (sI-A)^{-1} b$ \\
%     $\Rightarrow H(s)$ is SPR
% \item Then, $\exists$ a scalar $\varepsilon >0$, a vector $q$ 
%     and a symmetric positive definite matrix $P$, s.t.
%     \begin{alignat*}{3}
%     A^TP + PA   &= -qq^T - \varepsilon L\\
%     Pb - c      &= \sqrt{\gamma} q
%     \end{alignat*}
% \end{itemize}
% 
% \paragraph{Using it}
% We only need $\gamma=0$ in all cases (in this course).
% Hence we can say: if $H(s)$ is SPR $\Rightarrow \exists P=P^T>0$,
% s.t.
% \begin{alignat*}{3}
% A^TP + PA   &= -Q\\
% Pb &c   \quad \txt{"boundary condition, means SPR"}
% \end{alignat*}
% where $Q=Q^t>0$
% 
% % \subsection{Lemma: ``Adaptive laws based on Lyapunov for
% % relative degree 1 plants''}
% % 
% % Consider the dynamical system below%
% % \footnote{think of the error dynamics, not of the plant!}.
% % \begin{alignat*}{3}
% % \dot{x}(t) &= A x(t) + b \theta^T(t) \phi(t) \quad & x &\in \R^n\\
% % y(t) &= c^Tx(t) \quad           & y, z_1 &\in \R^1\\
% % z_1(t) &= ky(t)             & \phi, \theta & \in \R^k
% % \end{alignat*}
% % ``$z_1$ allows change of symbol.\\
% % 
% % where $(A,b)$ is stabilisable and $(c^T,A)$ 
% % is detectable and $c^T(sI-A)^{-1}b \corresponds H(s)$ 
% % is SPR.\\
% %  
% % Let $\theta(t)$ be a vector of adjustable parameters.\\
% % Let $\phi(t)$ and $z_1(t)$ be time-varying functions that can
% % be measured.\\
% % 
% % Then, if $\theta(t)$ is adjusted as
% % \begin{alignat}{3}
% % \dot{\theta}(t) &= -\sign{k} z_1(t) \phi(t)
% % \end{alignat}
% % (Adaptive law for multistate systems)
% % 
% % $\Rightarrow$ the equilibrium state $(x=0, \theta=0)$ 
% % is uniformly stable in the large.\\
% % uniformly stable: not dependent on time nor on IC\\
% % in the large: IC don't matter everywhere in $\R^n$.
% % 
% % \paragraph{Proof}
% % Since $H(s)$ is SPR, it follows from KY lemma that $\exists P = P^T >0$ 
% % such that
% % \begin{alignat}{3}
% % A^TP + PA = -Q, \quad \txt{with } Q^T = Q>0\\
% % Pb &= c
% % \end{alignat}
% % 
% % Let $V$ be a positive definite function
% % \begin{alignat}{3}
% % V &= x^TPx + \frac{1}{|k|} \theta^T \theta
% % \end{alignat}
% % 
% % Its time derivative along the system is
% % \begin{alignat}{3}
% % \dot{V} &= x^T \left( PA + A^TP \right)x + 2 x^TPb \theta^T\phi - 2\theta^Ty\phi\\
% %         &= -x^TQx \leq 0
% % \end{alignat}
% % 
% % Therefore, the origin of (1), (2) is stable.
% % %% TODO correct references.
% % 
% % \paragraph{Discussion}
% % We now have a simple tool for finding adaptive laws with
% % error dynamics
% % \begin{alignat*}{3}
% % e &= \frac{1}{k^*} M(s) [ \tilde{\theta}^T \phi]
% % \end{alignat*}
% % (where $M(s)$ SPR(s)tabilisable and detectable)
% % and the adaptive laws are
% % \begin{alignat}{3}
% % \dot{\theta} &= -\sign{\varepsilon} e \Gamma \phi
% % \end{alignat}
% % 
% % If $M(s)$ has relative degree 1, it is obvious that
% % $e(t) \rightarrow 0$ for $t \rightarrow \infty$.
% % (Why?)
% % 
% % \subsection{Performance considerations}
% % Engineering criteria:\\
% % \begin{tabu} to \columnwidth{|c|c|}
% % \toprule
% % Performance & Noise\\
% % \midrule
% % Disturbance & Robustness
% % \bottomrule
% % \end{tabu}
% % 
% % \begin{itemize}
% % \item Increasing $\gamma$, we are unhappy with the oscillations of our 
% %     parameters $\theta(t)$ and therefore with the
% %     oscillations of $u(t)$.
% % \item We have no clue what the adaptive closed loop will do between
% %     $t=0$ and $t=\infty$ other than boundedness.
% % \end{itemize}
% % 
% % \paragraph{Now}
% % Deal with transient response.
% % 
% % \paragraph{Idea}
% % Adaptation changes with signals.
% % \begin{alignat*}{3}
% % \left( \dot{\theta}(t) = - \sign{\varepsilon} e \gamma \phi \right),
% % \quad e, \gamma \txt{ changeable}
% % \end{alignat*}
% % 
% % We can alter the transient with $\gamma$ (leads to oscillations),
% % or we can change $e(t)$.
% % 
% % \paragraph{So far} Open loop reference model (ORM)
% % \begin{alignat}{3}
% % \dot{x}_m(t)^o &= a_m x_m(t)^o + k_m r(t)\\
% % \end{alignat}
% % 
% % %% TODO control block
% % 
% % \paragraph{Now} Closed loop reference model (CRM)
% % \begin{alignat}{3}
% % \dot{x}_m(t)^c &= a_m x_m(t)^c + k_m r(t) - l e^c(t)
% % \end{alignat}
% % 
% % ``CRM is observer-like; $M$ helps $G$ by moving towards
% % $G$ and retreating to original position.''
% % 
% % ORM $=$ CRM if $l=0$.
